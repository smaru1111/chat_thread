# 01. Vision - プロジェクトの思想と背景

## 🎯 なぜこのアプリを作るのか

### 現状の問題：線形チャットの限界

現在主流のチャット型LLM（ChatGPT、Claude、Geminiなど）は、**「時系列（線形）」で会話履歴を処理**する前提で設計されています。

しかし、人間同士の対話は本来もっと複雑で、以下のような特徴を持っています：

- **話題が分岐する**：一つの話題から複数の方向に議論が広がる
- **過去に戻る**：以前の話題を参照して新しい展開を生み出す
- **並列探索**：複数の仮説やアイデアを同時に検討する
- **文脈の選択的利用**：必要な部分だけを選んで対話を再開する

### 従来型チャットで起こる問題

線形構造の制約により、以下の問題が頻発します：

1. **文脈誤解・曖昧応答**
   - 複数の話題が混在すると、LLMがどの文脈で応答すべきか判断できない
   - 過去の会話が全て含まれるため、関係のない情報がノイズになる

2. **特定の話題に戻るのが困難**
   - 時系列でしか会話を追えないため、特定の話題を探すのが大変
   - 過去のメッセージを探すには、長い履歴をスクロールする必要がある

3. **情報が混線して思考の枝を追えない**
   - 複数の思考ラインが一つの線形ストリームに混ざる
   - どの議論がどの文脈から生まれたかが不明確

4. **過去の一部だけを選んで対話を再開できない**
   - 「このメッセージから別の方向で考え直したい」というニーズに対応できない
   - 会話全体をリセットするか、全ての履歴を引きずるかの二択しかない

---

## 🌟 このアプリが提供する価値

### コアバリュー：人間の思考構造と同じ形でLLMと会話できる

本プロジェクトは、従来の「線形チャット」を超えた  
**スレッド（ツリー）型の会話構造をLLMで扱えるチャットアプリ** を実現します。

### 主要コンセプト

#### 1. **会話をツリー構造で管理**
- 各メッセージが `parentMessageId` を持ち、**「どのメッセージから派生したか」** を明確に記録
- 会話の分岐と統合を自然に表現できる

#### 2. **任意のメッセージから対話を再開**
- ユーザーは過去の好きな地点から分岐し、新しい思考ライン（スレッド）を開始できる
- 「この回答から別の方向で考え直したい」というニーズに自然に対応

#### 3. **LLMにはスレッドの「先祖メッセージ」だけを送信**
- 選択されたメッセージが属するツリーの最上段メッセージ（0階層目）と、それ以前の0階層目メッセージ、そして最上段から選択メッセージまでの祖先チェーンだけを送信
- 選択された枝のコンテキストだけを安全に保持することで、誤解のない応答を実現
- 不要な情報を排除し、必要な文脈だけをLLMに渡す

#### 4. **人間の思考の自然構造をそのまま扱える「チャットを越えた対話体験」**

---

## 💡 想定されるユースケース

### アイデア探索
- 一つのアイデアから複数の方向性を並列に検討
- 各方向を独立したスレッドとして管理し、後で比較・統合

### 複数仮説の並列検討
- 問題解決において、複数のアプローチを同時に試す
- 各仮説を別スレッドで展開し、結果を比較

### 物語生成やコード分岐
- 物語の分岐点から複数の展開を探索
- コード設計の複数の実装方針を並列に検討

### 大量プロジェクトの文脈整理
- 複数のプロジェクトやタスクを一つの会話セッションで管理
- 各プロジェクトを独立したスレッドとして扱い、必要な時だけその文脈に戻る

---

## 🚀 未来の進化方向

### 短期目標（MVP）
- 基本的なツリー構造の会話管理（0階層目メッセージと子メッセージの階層管理）
- 任意のメッセージからの分岐機能
- コンテキストメッセージの自動抽出とLLMへの送信（ツリーの最上段までの0階層目 + 祖先チェーン）

### 中期目標
- スレッドの可視化とナビゲーション強化
- スレッドのマージ・統合機能
- スレッド間の参照・リンク機能

### 長期ビジョン
- **「思考の地図」としての会話管理**
  - 会話ツリーを視覚的に探索できるインターフェース
  - 重要な分岐点や結論を自動的にハイライト
  
- **マルチエージェント対応**
  - 異なる専門性を持つ複数のLLMエージェントが、異なるスレッドで並列に作業
  - エージェント間の協調と情報共有

- **知識グラフとの統合**
  - 会話ツリーから知識グラフを自動生成
  - 過去の会話から学んだ知識を再利用

- **コラボレーション機能**
  - 複数のユーザーが同じ会話ツリーを共有
  - 各ユーザーが異なるスレッドで作業し、結果を統合

---

## 🎨 設計思想の根幹

### 1. **人間中心設計**
- 技術的な制約ではなく、人間の思考パターンに合わせる
- 「使いやすさ」より「自然さ」を優先

### 2. **文脈の選択的利用**
- 全ての情報を送るのではなく、必要な情報だけを選ぶ
- LLMのトークン制限を効率的に活用

### 3. **非破壊的な探索**
- 一度決めた方向を捨てるのではなく、分岐として保存
- いつでも過去の分岐に戻れる安心感

### 4. **実験的アプローチ**
- 「正解」を最初から決めず、ユーザーの使い方を見て進化させる
- 失敗を恐れず、新しい会話体験を探索する

---

## 📝 このドキュメントの役割

このドキュメントは、プロジェクトの**「なぜ」**と**「何を目指すか」**を記録する場所です。

実装の詳細や技術的な制約に迷った時、このドキュメントに戻ることで、  
**「人間の思考構造と同じ形でLLMと会話できる未来」** という根幹のビジョンを再確認できます。

設計や実装の判断に迷った時は、常にこのビジョンに照らし合わせて判断してください。

